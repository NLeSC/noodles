

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Eating of Noodles (user docs) &mdash; Noodles 0.2.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Noodles 0.2.0 documentation" href="index.html"/>
        <link rel="next" title="Cooking of Noodles (library docs)" href="cooking.html"/>
        <link rel="prev" title="Welcome to Noodles’s documentation!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Noodles
          

          
            
            <img src="_static/nlesc-logo-white.svg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Eating of Noodles (user docs)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#a-first-example">A first example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#doing-things-parallel">Doing things parallel</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#running-workflows">Running workflows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#run-single-local-single-thread"><code class="docutils literal"><span class="pre">run_single</span></code>, local single thread</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-parallel-local-multi-thread"><code class="docutils literal"><span class="pre">run_parallel</span></code>, local multi-thread</a></li>
<li class="toctree-l3"><a class="reference internal" href="#run-process-local-multi-process"><code class="docutils literal"><span class="pre">run_process</span></code>, local multi-process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#xenon">Xenon</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hybrid-mode">Hybrid mode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cooking.html">Cooking of Noodles (library docs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="first_steps.html">First Steps</a></li>
<li class="toctree-l1"><a class="reference internal" href="poetry_tutorial.html">Real World Tutorial 1: Translating Poetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="boil_tutorial.html">Real World Tutorial 2: Boil, a make tool.</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Development documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="scheduler.html">The Noodles Scheduler</a></li>
<li class="toctree-l1"><a class="reference internal" href="brokers.html">Co-routine brokers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Noodles</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Eating of Noodles (user docs)</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/eating.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="eating-of-noodles-user-docs">
<h1>Eating of Noodles (user docs)<a class="headerlink" href="#eating-of-noodles-user-docs" title="Permalink to this headline">¶</a></h1>
<p>The purpose of Noodles is to make it easy to design <em>computational workflows</em> straight from Python.
Noodles is meant to be used by scientists that want to do heavy number crunching, and need a way to organise these computations in a readable and sustainable manner.
These workflows are usually associated with a <em>directed acyclic graph</em> (DAG, or just: graph).
Each computation in the workflow is a represented as a node in the graph and may have several dependencies.
These dependencies are the arrows; or if you think in reverse, the arrows show transport of data.</p>
<div class="section" id="a-first-example">
<h2>A first example<a class="headerlink" href="#a-first-example" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s look at a small example creating a diamond workflow. All the examples in this documentation do some silly arithmetic. In practice these functions would do quite a bit heavier lifting.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">noodles</span> <span class="kn">import</span> <span class="n">run_single</span>
<span class="kn">from</span> <span class="nn">noodles.tutorial</span> <span class="kn">import</span> <span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">mul</span><span class="p">)</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">mul</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span>

<span class="n">answer</span> <span class="o">=</span> <span class="n">run_single</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;The answer is {0}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">answer</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>That allmost looks like normal Python! The only difference is the <code class="docutils literal"><span class="pre">run_single</span></code> statement at the end of this program.
The catch is that none of the computation is actually done until the <code class="docutils literal"><span class="pre">run_single</span></code> statement has been given.
The variables <code class="docutils literal"><span class="pre">u</span></code>, <code class="docutils literal"><span class="pre">v</span></code>, <code class="docutils literal"><span class="pre">w</span></code>, and <code class="docutils literal"><span class="pre">x</span></code> only represent the <em>promise</em> of a value.
The functions that we imported are wrapped, such that they construct the directed acyclic graph of the computation in stead of just computing the result immediately.
This DAG then looks like this:</p>
<div class="figure align-center" id="id2" style="width: 50%">
<img alt="the diamond workflow DAG" src="_images/dag1.png" />
<p class="caption"><span class="caption-text">The diamond workflow.</span></p>
</div>
<p>Running this program will first evaluate the result to <code class="docutils literal"><span class="pre">add(5,</span> <span class="pre">4)</span></code>.
The resulting value is then inserted into the empty slots in the depending nodes.
Each time a node has no empty slots left, it is scheduled for evaluation.
At the end, the program should print:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">answer</span> <span class="ow">is</span> <span class="mf">42.</span>
</pre></div>
</div>
<p>At this point it is good to know what the module <code class="docutils literal"><span class="pre">noodles.tutorial</span></code> looks like.
It looks very simple.
However, you should be aware of what happens behind the curtains, to understand the limitations of this approach.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">noodles</span> <span class="kn">import</span> <span class="n">schedule</span>

<span class="nd">@schedule</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Adding up numbers! (is very uplifting)&quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="nd">@schedule</span>
<span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Subtracting numbers.&quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>

<span class="nd">@schedule</span>
<span class="k">def</span> <span class="nf">mul</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;Multiplying numbers.&quot;&quot;&quot;</span>
  <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">b</span>

<span class="o">...</span>
</pre></div>
</td></tr></table></div>
<p>The <code class="docutils literal"><span class="pre">&#64;schedule</span></code> decorators takes care that the functions actually return <em>promises</em> instead of values.
Such a <code class="docutils literal"><span class="pre">PromisedObject</span></code> is a placeholder for the expected result.
It stores the workflow graph that is needed to compute the promise.
When another <code class="xref py py-obj docutils literal"><span class="pre">schedule</span></code>-decorated function is called with a promise, the graphs of the dependencies are merged to create a new workflow graph.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The promised object can be of any type and can be used as a normal object.
You access attributes and functions of the object that is promised as you normally would.
Be aware, however, that it is important to program in a functional way, so changing the attributes of a promised object is not a good idea.
Instead, return a copy of the object with the changed values.</p>
</div>
<div class="section" id="doing-things-parallel">
<h3>Doing things parallel<a class="headerlink" href="#doing-things-parallel" title="Permalink to this headline">¶</a></h3>
<p>Using the Noodles approach it becomes very easy to paralellise computations. Let&#8217;s look at a second example.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">noodles</span> <span class="kn">import</span> <span class="p">(</span><span class="n">gather</span><span class="p">,</span> <span class="n">run_parallel</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">noodles.tutorial</span> <span class="kn">import</span> <span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">mul</span><span class="p">,</span> <span class="n">accumulate</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">my_func</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mul</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>


<span class="n">u</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">sub</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="p">[</span><span class="n">my_func</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">accumulate</span><span class="p">(</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">w</span><span class="p">))</span>

<span class="n">answer</span> <span class="o">=</span> <span class="n">run_parallel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n_threads</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s2">&quot;The answer is {0}, again.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">answer</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>This time the workflow graph will look a bit more complicated.</p>
<div class="figure align-center" id="id3" style="width: 100%">
<img alt="the workflow graph of the second example" src="_images/dag2.png" />
<p class="caption"><span class="caption-text">The workflow graph of the second example.</span></p>
</div>
<p>Here we see how a user can define normal python functions and use them to build a larger workflow.
Furthermore, we introduce a new bit of magic: the <code class="docutils literal"><span class="pre">gather</span></code> function.
When you build a list of computations using a list-comprehension like above, you essentially store a <em>list of promises</em> in variable <code class="docutils literal"><span class="pre">w</span></code>.
However, schedule-decorated functions cannot easily see which arguments contain promised values, such as <code class="docutils literal"><span class="pre">w</span></code>, and which arguments are plain Python.
The <code class="docutils literal"><span class="pre">gather</span></code> function converts the list of promises into a promise of a list, making it clear to the scheduled function this argument is a promise.
The <code class="docutils literal"><span class="pre">gather</span></code> function is defined as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@schedule</span>
<span class="k">def</span> <span class="nf">gather</span><span class="p">(</span><span class="o">*</span><span class="n">lst</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">lst</span>
</pre></div>
</div>
<p>By unpacking the list (by doing <code class="docutils literal"><span class="pre">gather(*w)</span></code>) in the call to gather, each item in <code class="docutils literal"><span class="pre">w</span></code> becomes a dependency of the <code class="docutils literal"><span class="pre">gather</span></code> node in this workflow, as we can see in the figure above.</p>
<p>To make use of the parallelism in this workflow, we run it with <code class="docutils literal"><span class="pre">run_parallel</span></code>.
This runner function creates a specified number of threads, each taking jobs from the Noodles scheduler and returning results.</p>
</div>
</div>
<div class="section" id="running-workflows">
<h2>Running workflows<a class="headerlink" href="#running-workflows" title="Permalink to this headline">¶</a></h2>
<p>Noodles ships with a few ready-made functions that run the workflow for you, depending on the amount of work that needs to be done.</p>
<div class="section" id="run-single-local-single-thread">
<h3><code class="docutils literal"><span class="pre">run_single</span></code>, local single thread<a class="headerlink" href="#run-single-local-single-thread" title="Permalink to this headline">¶</a></h3>
<p>Runs your workflow in the same thread as the caller.
This function is mainly for testing.
When running workflows you almost always want to use one of the other functions.</p>
</div>
<div class="section" id="run-parallel-local-multi-thread">
<h3><code class="docutils literal"><span class="pre">run_parallel</span></code>, local multi-thread<a class="headerlink" href="#run-parallel-local-multi-thread" title="Permalink to this headline">¶</a></h3>
<p>Runs your workflow in parallel using any number of threads.
Usually, specifying the number of cores in your CPU will give optimal performance for this runner.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are very <strong>very</strong> certain that your workflow will never need to scale to cluster-computing, this runner is more lenient on the kinds of Python that is supported, because function arguments are not converted to and from JSON. Think of nested functions, lambda forms, generators, etc.</p>
</div>
</div>
<div class="section" id="run-process-local-multi-process">
<h3><code class="docutils literal"><span class="pre">run_process</span></code>, local multi-process<a class="headerlink" href="#run-process-local-multi-process" title="Permalink to this headline">¶</a></h3>
<p>Starts a second process to run jobs. This is usefull for testing the JSON compatability of your workflow on your own machine.</p>
</div>
<div class="section" id="xenon">
<h3>Xenon<a class="headerlink" href="#xenon" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="http://nlesc.github.io/Xenon/">Xenon</a> is a Java library offering a uniform interface to all manners of job schedulers. Running a job on your local machine is as easy as submitting it to SLURM or Torque on your groceries supercomputer. To talk to Xenon from Python we use <a class="reference external" href="http://github.com/NLeSC/pyxenon">pyxenon</a>.</p>
<p>Using the Xenon runner, there are two modes of operation: <em>batch</em> and <em>online</em>. In online mode, jobs are streamed to the worker and results read back. If your laptop crashes while an online computation is running, that is to say, the connection is broken, the worker dies and you may lose results. Getting the online mode to be more robust is one of the aims for upcomming releases.</p>
<p>The Xenon runner needs a way to setup the virtualenv on the remote side, so a worker script needs to be specified. We have included a bash-script <code class="docutils literal"><span class="pre">worker.sh</span></code> that should work in the simplest cases.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1"># run in the directory where the script is located</span>
<span class="nb">cd</span> <span class="s2">&quot;</span><span class="k">$(</span>dirname <span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span>

<span class="c1"># activate the virtualenv that is given as first argument</span>
<span class="c1"># invoking this script.</span>
<span class="k">if</span> <span class="o">[</span> -e <span class="nv">$1</span>/bin/activate <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="nb">source</span> <span class="nv">$1</span>/bin/activate<span class="p">;</span>
<span class="k">fi</span>

<span class="c1"># start the worker with the rest of the arguments.</span>
<span class="c1"># stderr is written to a file.</span>
python -m noodles.worker <span class="si">${</span><span class="p">@:</span><span class="nv">2</span><span class="si">}</span> 2&gt; errlog

<span class="c1"># close the virtualenv.</span>
<span class="k">if</span> <span class="o">[</span> -z <span class="si">${</span><span class="nv">VIRTUAL_ENV</span><span class="p">+x</span><span class="si">}</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    deactivate<span class="p">;</span>
<span class="k">fi</span>
</pre></div>
</div>
<p>If you need to setup some more aspects of the environment, load modules, set variables etc., modify this script and put it in the directory where you want to run the jobs. Specify this directory in the Python script.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">noodles</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">serial</span><span class="p">,</span> <span class="n">gather</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">noodles.run.xenon</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">XenonConfig</span><span class="p">,</span> <span class="n">RemoteJobConfig</span><span class="p">,</span> <span class="n">XenonKeeper</span><span class="p">,</span> <span class="n">run_xenon_prov</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">noodles.display</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">NCDisplay</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">noodles.tutorial</span> <span class="kn">import</span> <span class="n">add</span><span class="p">,</span> <span class="n">accumulate</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">add</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">accumulate</span><span class="p">(</span><span class="n">gather</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">))</span>

    <span class="c1"># XenonKeeper is the root Xenon object that gives access</span>
    <span class="c1"># to the Xenon Java library</span>
    <span class="k">with</span> <span class="n">XenonKeeper</span><span class="p">()</span> <span class="k">as</span> <span class="n">Xe</span><span class="p">:</span>
        <span class="c1"># We recommend loging in on your compute resource</span>
        <span class="c1"># through private/public key pairs. This prevents</span>
        <span class="c1"># passwords ending up as ASCII in your source files.</span>
        <span class="n">certificate</span> <span class="o">=</span> <span class="n">Xe</span><span class="o">.</span><span class="n">credentials</span><span class="o">.</span><span class="n">newCertificateCredential</span><span class="p">(</span>
            <span class="s1">&#39;ssh&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/.ssh/id_rsa&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;username&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>

        <span class="c1"># Configure Xenon to access your favourite super computer.</span>
        <span class="n">xenon_config</span> <span class="o">=</span> <span class="n">XenonConfig</span><span class="p">(</span>
            <span class="n">jobs_scheme</span><span class="o">=</span><span class="s1">&#39;slurm&#39;</span><span class="p">,</span>
            <span class="n">location</span><span class="o">=</span><span class="s1">&#39;login.super-duper-computer.darpa.net&#39;</span><span class="p">,</span>
            <span class="n">credential</span><span class="o">=</span><span class="n">certificate</span>
        <span class="p">)</span>

        <span class="c1"># Specify how to submit jobs.</span>
        <span class="n">job_config</span> <span class="o">=</span> <span class="n">RemoteJobConfig</span><span class="p">(</span>
            <span class="n">registry</span><span class="o">=</span><span class="n">serial</span><span class="o">.</span><span class="n">base</span><span class="p">,</span>
            <span class="n">prefix</span><span class="o">=</span><span class="s1">&#39;&lt;path-to-virtualenv&gt;&#39;</span><span class="p">,</span>
            <span class="n">working_dir</span><span class="o">=</span><span class="s1">&#39;&lt;project-path&gt;&#39;</span><span class="p">,</span>
            <span class="n">time_out</span><span class="o">=</span><span class="mi">5000</span>
        <span class="p">)</span>


        <span class="c1"># Run jobs with NCurses based console feedback</span>
        <span class="k">with</span> <span class="n">NCDisplay</span><span class="p">()</span> <span class="k">as</span> <span class="n">display</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">run_xenon_prov</span><span class="p">(</span>
                <span class="n">b</span><span class="p">,</span> <span class="n">Xe</span><span class="p">,</span> <span class="s2">&quot;cache.json&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">xenon_config</span><span class="p">,</span> <span class="n">job_config</span><span class="p">,</span>
                <span class="n">display</span><span class="o">=</span><span class="n">display</span><span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s2">&quot;This test is working {0}%!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="hybrid-mode">
<h3>Hybrid mode<a class="headerlink" href="#hybrid-mode" title="Permalink to this headline">¶</a></h3>
<p>We may have a situation where a workflow consists of some very heavy <em>compute</em> jobs and a lot of smaller jobs that do some bookkeeping. If we were to schedule all the menial jobs to a SLURM queue we actually slow down the computation through the overhead of job submission. The Noodles cook may provide the schedule functions with hints on the type of job the function represents. Depending on these hints we may dispatch the job to a remote worker or keep it on the local machine.</p>
<p>We provide an example on how to use the hybrid worker in the source.</p>
<p>If you really need to, it is not too complicated to develop your own job runner based on some of these examples. Elsewhere in this documentation we elaborate on the architecture and interaction between runners and the scheduler, see: <a class="reference internal" href="scheduler.html#noodles-scheduler"><span class="std std-ref">The Noodles Scheduler</span></a>.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cooking.html" class="btn btn-neutral float-right" title="Cooking of Noodles (library docs)" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to Noodles’s documentation!" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2016, Johan Hidding, Felipe Zapata, Berend Weel.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
